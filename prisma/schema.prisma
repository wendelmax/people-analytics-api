generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum SkillType {
  HARD
  SOFT
}

enum SkillCategory {
  TECHNICAL
  SOFT
  LEADERSHIP
  DOMAIN
  CORE
}

enum SkillLevel {
  BEGINNER
  INTERMEDIATE
  ADVANCED
  EXPERT
}

enum FeedbackType {
  PERFORMANCE
  SKILL
  BEHAVIOR
  PROJECT
}

enum SentimentType {
  POSITIVE
  NEUTRAL
  NEGATIVE
}

enum RecommendationSource {
  AI
  PERFORMANCE
  PEER
  MANAGER
}

enum RecommendationPriority {
  LOW
  MEDIUM
  HIGH
  CRITICAL
}

enum RecommendationStatus {
  OPEN
  IN_PROGRESS
  COMPLETED
  DISMISSED
}

enum ProjectStatus {
  PLANNING
  IN_PROGRESS
  COMPLETED
  ON_HOLD
  CANCELLED
}

enum TrainingType {
  ONLINE_COURSE
  WORKSHOP
  CONFERENCE
  INTERNAL_TRAINING
  EXTERNAL_COURSE
}

enum TrainingStatus {
  ENROLLED
  IN_PROGRESS
  COMPLETED
  DROPPED
}

enum PerformanceReviewStatus {
  DRAFT
  IN_PROGRESS
  PENDING_EMPLOYEE
  PENDING_MANAGER
  COMPLETED
}

enum GoalType {
  PERFORMANCE
  DEVELOPMENT
  PROJECT
  CAREER
  ORGANIZATIONAL
}

enum GoalPriority {
  LOW
  MEDIUM
  HIGH
  CRITICAL
}

enum GoalStatus {
  NOT_STARTED
  IN_PROGRESS
  ON_TRACK
  AT_RISK
  COMPLETED
  CANCELLED
}

enum DevelopmentPlanStatus {
  DRAFT
  IN_PROGRESS
  COMPLETED
  ABANDONED
}

enum DevelopmentItemStatus {
  NOT_STARTED
  IN_PROGRESS
  COMPLETED
  BLOCKED
}

enum OnboardingStatus {
  NOT_STARTED
  IN_PROGRESS
  COMPLETED
  CANCELLED
}

enum OffboardingStatus {
  NOT_STARTED
  IN_PROGRESS
  COMPLETED
  CANCELLED
}

enum EmployeeJourneyStatus {
  PLANNED
  ACTIVE
  COMPLETED
  CANCELLED
}

enum MentoringStatus {
  ACTIVE
  COMPLETED
  PAUSED
}

enum AuditAction {
  CREATE
  UPDATE
  DELETE
  VIEW
  LOGIN
  LOGOUT
}

enum NotificationChannel {
  EMAIL
  SMS
  PUSH
  SLACK
}

enum NotificationStatus {
  PENDING
  SENT
  READ
}

enum KnowledgeCategory {
  POLICY
  PROCESS
  TRAINING
  FAQ
  OTHER
}

enum AssessmentPeriodStatus {
  DRAFT
  ACTIVE
  CLOSED
}

enum CompetencyAssessmentStatus {
  PLANNED
  IN_PROGRESS
  COMPLETED
  CANCELLED
}

enum AdminRole {
  SUPER_ADMIN
  ORG_ADMIN
  HR_ADMIN
}

model Department {
  id          String     @id @default(uuid())
  name        String     @unique
  description String?
  positions   Position[]
  employees   Employee[]
  journeys    EmployeeJourney[]
  knowledgeArticles KnowledgeArticle[]
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt
}

model Position {
  id           String      @id @default(uuid())
  title        String
  description  String?
  level        String?
  departmentId String?
  department   Department? @relation(fields: [departmentId], references: [id])
  employees    Employee[]
  careerPaths  CareerPathPosition[]
  journeys     EmployeeJourney[]
  createdAt    DateTime    @default(now())
  updatedAt    DateTime    @updatedAt

  @@unique([departmentId, title])
}

model Skill {
  id                  String                @id @default(uuid())
  name                String                @unique
  description         String?
  type                SkillType
  category            SkillCategory
  defaultLevel        SkillLevel            @default(BEGINNER)
  employeeLinks       EmployeeSkill[]
  projectLinks        ProjectSkill[]
  trainingLinks       TrainingSkill[]
  recommendationLinks RecommendationSkill[]
  createdAt           DateTime              @default(now())
  updatedAt           DateTime              @updatedAt
  DevelopmentPlanItem DevelopmentPlanItem[]
  careerPaths         CareerPathSkill[]
  knowledgeArticles   KnowledgeArticleSkill[]
  competencyAssessments CompetencySkillAssessment[]
  skillProgress       SkillProgressEntry[]
}

model Employee {
  id                 String                   @id @default(uuid())
  name               String
  email              String                   @unique
  phone              String?
  hireDate           DateTime
  departmentId       String
  positionId         String
  managerId          String?
  status             String?
  department         Department               @relation(fields: [departmentId], references: [id])
  position           Position                 @relation(fields: [positionId], references: [id])
  manager            Employee?                @relation("EmployeeManager", fields: [managerId], references: [id])
  reports            Employee[]               @relation("EmployeeManager")
  skills             EmployeeSkill[]
  projects           EmployeeProject[]
  trainings          EmployeeTraining[]
  performanceReviews PerformanceReview[]      @relation("ReviewEmployee")
  reviewsAuthored    PerformanceReview[]      @relation("ReviewReviewer")
  goals              Goal[]
  feedbackGiven      Feedback[]               @relation("FeedbackAuthor")
  feedbackReceived   Feedback[]               @relation("FeedbackRecipient")
  mentoringAsMentor  MentoringRelationship[]  @relation("Mentor")
  mentoringAsMentee  MentoringRelationship[]  @relation("Mentee")
  notifications      Notification[]
  notificationPrefs  NotificationPreference[]
  recommendations    Recommendation[]
  developmentPlans   DevelopmentPlan[]
  auditLogs          AuditLog[]
  onboardingWorkflows Onboarding[]
  offboardingWorkflows Offboarding[]
  journeys           EmployeeJourney[]
  knowledgeArticles  KnowledgeArticle[]
  competencyAssessments CompetencyAssessment[] @relation("AssessmentEmployee")
  competencyReviews   CompetencyAssessment[] @relation("AssessmentReviewer")
  skillProgress       SkillProgressEntry[]
  adminProfile        Admin?
  createdAt          DateTime                 @default(now())
  updatedAt          DateTime                 @updatedAt
  Project            Project[]
}

model EmployeeSkill {
  employeeId    String
  skillId       String
  proficiency   SkillLevel @default(BEGINNER)
  lastEvaluated DateTime?  @default(now())

  employee Employee @relation(fields: [employeeId], references: [id])
  skill    Skill    @relation(fields: [skillId], references: [id])

  @@id([employeeId, skillId])
}

model Project {
  id             String            @id @default(uuid())
  name           String
  description    String?
  startDate      DateTime
  endDate        DateTime?
  status         ProjectStatus
  budget         Float?
  ownerId        String?
  owner          Employee?         @relation(fields: [ownerId], references: [id])
  team           EmployeeProject[]
  requiredSkills ProjectSkill[]
  createdAt      DateTime          @default(now())
  updatedAt      DateTime          @updatedAt
}

model EmployeeProject {
  id         String    @id @default(uuid())
  employeeId String
  projectId  String
  role       String
  startDate  DateTime
  endDate    DateTime?

  employee Employee @relation(fields: [employeeId], references: [id])
  project  Project  @relation(fields: [projectId], references: [id])

  @@unique([employeeId, projectId])
}

model ProjectSkill {
  projectId String
  skillId   String

  project Project @relation(fields: [projectId], references: [id])
  skill   Skill   @relation(fields: [skillId], references: [id])

  @@id([projectId, skillId])
}

model Training {
  id           String             @id @default(uuid())
  name         String
  description  String?
  provider     String?
  type         TrainingType
  status       TrainingStatus
  startDate    DateTime
  endDate      DateTime?
  difficulty   String?
  skills       TrainingSkill[]
  participants EmployeeTraining[]
  createdAt    DateTime           @default(now())
  updatedAt    DateTime           @updatedAt
}

model TrainingSkill {
  trainingId String
  skillId    String

  training Training @relation(fields: [trainingId], references: [id])
  skill    Skill    @relation(fields: [skillId], references: [id])

  @@id([trainingId, skillId])
}

model EmployeeTraining {
  id          String         @id @default(uuid())
  employeeId  String
  trainingId  String
  status      TrainingStatus
  startedAt   DateTime
  completedAt DateTime?

  employee Employee @relation(fields: [employeeId], references: [id])
  training Training @relation(fields: [trainingId], references: [id])

  @@unique([employeeId, trainingId])
}

model Feedback {
  id          String        @id @default(uuid())
  authorId    String
  recipientId String
  type        FeedbackType
  sentiment   SentimentType
  title       String
  content     String
  rating      Int?
  tags        String[]
  createdAt   DateTime      @default(now())
  updatedAt   DateTime      @updatedAt

  author    Employee @relation("FeedbackAuthor", fields: [authorId], references: [id])
  recipient Employee @relation("FeedbackRecipient", fields: [recipientId], references: [id])
}

model Recommendation {
  id          String                 @id @default(uuid())
  employeeId  String
  title       String
  description String?
  source      RecommendationSource
  priority    RecommendationPriority
  status      RecommendationStatus
  createdAt   DateTime               @default(now())
  updatedAt   DateTime               @updatedAt

  employee Employee              @relation(fields: [employeeId], references: [id])
  skills   RecommendationSkill[]
}

model RecommendationSkill {
  recommendationId String
  skillId          String

  recommendation Recommendation @relation(fields: [recommendationId], references: [id])
  skill          Skill          @relation(fields: [skillId], references: [id])

  @@id([recommendationId, skillId])
}

model PerformanceReview {
  id            String                  @id @default(uuid())
  employeeId    String
  reviewerId    String
  periodStart   DateTime
  periodEnd     DateTime
  status        PerformanceReviewStatus
  overallRating Float?
  strengths     String[]
  improvements  String[]
  comments      String?
  createdAt     DateTime                @default(now())
  updatedAt     DateTime                @updatedAt

  employee Employee @relation("ReviewEmployee", fields: [employeeId], references: [id])
  reviewer Employee @relation("ReviewReviewer", fields: [reviewerId], references: [id])
}

model Goal {
  id          String       @id @default(uuid())
  employeeId  String
  title       String
  description String?
  type        GoalType
  priority    GoalPriority
  status      GoalStatus
  startDate   DateTime
  targetDate  DateTime
  progress    Float        @default(0)
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt

  employee Employee @relation(fields: [employeeId], references: [id])
}

model DevelopmentPlan {
  id          String                @id @default(uuid())
  employeeId  String
  title       String
  description String?
  status      DevelopmentPlanStatus
  startDate   DateTime
  targetDate  DateTime
  createdAt   DateTime              @default(now())
  updatedAt   DateTime              @updatedAt

  employee Employee              @relation(fields: [employeeId], references: [id])
  items    DevelopmentPlanItem[]
}

model DevelopmentPlanItem {
  id                String                @id @default(uuid())
  developmentPlanId String
  title             String
  description       String?
  status            DevelopmentItemStatus
  skillId           String?
  dueDate           DateTime?
  completedAt       DateTime?

  plan  DevelopmentPlan @relation(fields: [developmentPlanId], references: [id])
  skill Skill?          @relation(fields: [skillId], references: [id])
}

model MentoringRelationship {
  id        String          @id @default(uuid())
  mentorId  String
  menteeId  String
  status    MentoringStatus
  startDate DateTime
  endDate   DateTime?
  goals     String[]
  notes     String?

  mentor Employee @relation("Mentor", fields: [mentorId], references: [id])
  mentee Employee @relation("Mentee", fields: [menteeId], references: [id])

  @@unique([mentorId, menteeId])
}

model Notification {
  id         String              @id @default(uuid())
  employeeId String
  channel    NotificationChannel
  status     NotificationStatus
  title      String
  message    String
  metadata   Json?
  sentAt     DateTime?
  readAt     DateTime?
  createdAt  DateTime            @default(now())
  updatedAt  DateTime            @updatedAt

  employee Employee @relation(fields: [employeeId], references: [id])
}

model NotificationPreference {
  id         String              @id @default(uuid())
  employeeId String
  channel    NotificationChannel
  enabled    Boolean             @default(true)
  createdAt  DateTime            @default(now())
  updatedAt  DateTime            @updatedAt

  employee Employee @relation(fields: [employeeId], references: [id])

  @@unique([employeeId, channel])
}

model Onboarding {
  id          String           @id @default(uuid())
  employeeId  String
  status      OnboardingStatus
  startDate   DateTime?
  completedAt DateTime?
  createdAt   DateTime         @default(now())
  updatedAt   DateTime         @updatedAt

  employee Employee        @relation(fields: [employeeId], references: [id])
  tasks    OnboardingTask[]
}

model OnboardingTask {
  id           String     @id @default(uuid())
  onboardingId String
  title        String
  description  String?
  dueDate      DateTime?
  completedAt  DateTime?
  createdAt    DateTime   @default(now())
  updatedAt    DateTime   @updatedAt

  onboarding Onboarding @relation(fields: [onboardingId], references: [id])

  @@index([onboardingId])
}

model Offboarding {
  id          String            @id @default(uuid())
  employeeId  String
  status      OffboardingStatus
  exitDate    DateTime?
  completedAt DateTime?
  createdAt   DateTime          @default(now())
  updatedAt   DateTime          @updatedAt

  employee Employee         @relation(fields: [employeeId], references: [id])
  tasks    OffboardingTask[]
}

model OffboardingTask {
  id            String     @id @default(uuid())
  offboardingId String
  title         String
  description   String?
  dueDate       DateTime?
  completedAt   DateTime?
  createdAt     DateTime   @default(now())
  updatedAt     DateTime   @updatedAt

  offboarding Offboarding @relation(fields: [offboardingId], references: [id])

  @@index([offboardingId])
}

model EmployeeJourney {
  id            String                @id @default(uuid())
  employeeId    String
  departmentId  String?
  positionId    String?
  type          String
  description   String?
  status        EmployeeJourneyStatus
  startDate     DateTime
  endDate       DateTime?
  createdAt     DateTime              @default(now())
  updatedAt     DateTime              @updatedAt

  employee   Employee  @relation(fields: [employeeId], references: [id])
  department Department? @relation(fields: [departmentId], references: [id])
  position   Position?   @relation(fields: [positionId], references: [id])
  touchpoints EmployeeJourneyTouchpoint[]

  @@index([employeeId])
  @@index([departmentId])
  @@index([positionId])
}

model EmployeeJourneyTouchpoint {
  id               String          @id @default(uuid())
  journeyId        String
  title            String
  description      String?
  occurredAt       DateTime
  createdAt        DateTime        @default(now())
  updatedAt        DateTime        @updatedAt

  journey EmployeeJourney @relation(fields: [journeyId], references: [id])

  @@index([journeyId])
}

model CareerPath {
  id          String              @id @default(uuid())
  name        String
  description String?
  createdAt   DateTime            @default(now())
  updatedAt   DateTime            @updatedAt

  stages        CareerPathStage[]
  positionLinks CareerPathPosition[]
  skillLinks    CareerPathSkill[]
}

model CareerPathStage {
  id           String     @id @default(uuid())
  careerPathId String
  title        String
  description  String?
  order        Int

  careerPath CareerPath @relation(fields: [careerPathId], references: [id])

  @@index([careerPathId])
}

model CareerPathPosition {
  careerPathId String
  positionId   String

  careerPath CareerPath @relation(fields: [careerPathId], references: [id])
  position   Position   @relation(fields: [positionId], references: [id])

  @@id([careerPathId, positionId])
}

model CareerPathSkill {
  careerPathId String
  skillId      String

  careerPath CareerPath @relation(fields: [careerPathId], references: [id])
  skill      Skill      @relation(fields: [skillId], references: [id])

  @@id([careerPathId, skillId])
}

model AuditLog {
  id        String      @id @default(uuid())
  userId    String
  action    AuditAction
  entity    String
  entityId  String
  oldValue  Json?
  newValue  Json?
  createdAt DateTime    @default(now())

  user Employee @relation(fields: [userId], references: [id])
}

model KnowledgeArticle {
  id          String            @id @default(uuid())
  authorId    String
  departmentId String?
  title       String
  content     String
  category    KnowledgeCategory
  tags        String[]
  publishedAt DateTime?
  createdAt   DateTime          @default(now())
  updatedAt   DateTime          @updatedAt

  author     Employee  @relation(fields: [authorId], references: [id])
  department Department? @relation(fields: [departmentId], references: [id])
  skillLinks KnowledgeArticleSkill[]
}

model KnowledgeArticleSkill {
  articleId String
  skillId   String

  article KnowledgeArticle @relation(fields: [articleId], references: [id])
  skill   Skill            @relation(fields: [skillId], references: [id])

  @@id([articleId, skillId])
}

model AssessmentPeriod {
  id        String                  @id @default(uuid())
  name      String
  status    AssessmentPeriodStatus  @default(DRAFT)
  startDate DateTime
  endDate   DateTime
  createdAt DateTime                @default(now())
  updatedAt DateTime                @updatedAt

  assessments CompetencyAssessment[]
}

model CompetencyAssessment {
  id          String                     @id @default(uuid())
  periodId    String
  employeeId  String
  reviewerId  String?
  status      CompetencyAssessmentStatus @default(PLANNED)
  overallScore Float?
  comments    String?
  createdAt   DateTime                   @default(now())
  updatedAt   DateTime                   @updatedAt

  period   AssessmentPeriod @relation(fields: [periodId], references: [id])
  employee Employee          @relation("AssessmentEmployee", fields: [employeeId], references: [id])
  reviewer Employee?         @relation("AssessmentReviewer", fields: [reviewerId], references: [id])
  skillRatings CompetencySkillAssessment[]

  @@index([periodId])
  @@index([employeeId])
}

model CompetencySkillAssessment {
  id            String   @id @default(uuid())
  assessmentId  String
  skillId       String
  rating        Int
  comments      String?
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  assessment CompetencyAssessment @relation(fields: [assessmentId], references: [id])
  skill      Skill                @relation(fields: [skillId], references: [id])

  @@index([assessmentId])
  @@index([skillId])
}

model SkillProgressEntry {
  id          String     @id @default(uuid())
  employeeId  String
  skillId     String
  proficiency SkillLevel
  evidence    String?
  createdAt   DateTime   @default(now())

  employee Employee @relation(fields: [employeeId], references: [id])
  skill    Skill    @relation(fields: [skillId], references: [id])

  @@index([employeeId])
  @@index([skillId])
}

model Admin {
  id         String    @id @default(uuid())
  employeeId String    @unique
  role       AdminRole
  notes      String?
  createdAt  DateTime  @default(now())
  updatedAt  DateTime  @updatedAt

  employee Employee @relation(fields: [employeeId], references: [id])
}
